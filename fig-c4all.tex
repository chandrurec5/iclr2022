\begin{tikzpicture}

\node []  (dnn-text)at (0,3.0) {CNN-GAP};

\node []  (dnn-output) at (-0.25+4-0.5,2.5) {$\hat{y}(x)$};
\node []  (dnn-smax) at (-1.25+4-0.5,2.5) {\tiny{FC}};
\draw [-stealth,thick]   (dnn-smax.east) -- (dnn-output.west);

\node [rotate=-90]  (dnn-gap) at (-2+4-0.5,2.5) {\tiny{GAP}};
\draw [-stealth,thick]   (dnn-gap.north) -- (dnn-smax.west);

\node [rotate=-90] (dnn-relu-4) at (-2.75+4-0.5,2.5){\tiny{ReLU}};
\node [] (dnn-c4) at (-3.5+4-0.5,2.5){\tiny{$C_4$}};
\draw [-stealth,thick]   (dnn-c4.east) -- (dnn-relu-4.south);
\draw [-stealth,thick]   (dnn-relu-4.north) -- (dnn-gap.south);

\node [rotate=-90] (dnn-relu-3) at (-4.25+4-0.5,2.5){\tiny{ReLU}};
\node [] (dnn-c3) at (-5+4-0.5,2.5){\tiny{$C_3$}};
\draw [-stealth,thick]   (dnn-c3.east) -- (dnn-relu-3.south);
\draw [-stealth,thick]   (dnn-relu-3.north) -- (dnn-c4.west);


\node [rotate=-90] (dnn-relu-2) at (-5.75+4-0.5,2.5){\tiny{ReLU}};
\node [] (dnn-c2) at (-6.5+4-0.5,2.5){\tiny{$C_2$}};
\draw [-stealth,thick]   (dnn-c2.east) -- (dnn-relu-2.south);
\draw [-stealth,thick]   (dnn-relu-2.north) -- (dnn-c3.west);

\node [rotate=-90] (dnn-relu-1) at (-7.25+4-0.5,2.5){\tiny{ReLU}};
\node [] (dnn-c1) at (-8+4-0.5,2.5){\tiny{$C_1$}};
\draw [-stealth,thick]   (dnn-c1.east) -- (dnn-relu-1.south);
\draw [-stealth,thick]   (dnn-relu-1.north) -- (dnn-c2.west);



\node [] (dnn-input) at (-8.75+4-0.5,2.5){$x$};
\draw [-stealth,thick]   (dnn-input.east) -- (dnn-c1.west);


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\node []  (fntext)at (5.125,-3.5) {CNN-GAP-DGN};

%\node []  (output) at (7.5,1.5) {$\hat{y}(x)$};


\node [] (dgn-f-c4) at (6.25,1.5){\tiny{$C^{\text{f}}_4$}};


\node [rotate=-90] (dgn-relu-3) at (5.5,1.5){\tiny{ReLU}};
\node [] (dgn-f-c3) at (4.75,1.5){\tiny{$C^{\text{f}}_3$}};
\draw [-stealth,thick]   (dgn-f-c3.east) -- (dgn-relu-3.south);
\draw [-stealth,thick]   (dgn-relu-3.north) -- (dgn-f-c4.west);


\node [rotate=-90] (dgn-relu-2) at (4.0,1.5){\tiny{ReLU}};
\node [] (dgn-f-c2) at (3.25,1.5){\tiny{$C^{\text{f}}_2$}};
\draw [-stealth,thick]   (dgn-f-c2.east) -- (dgn-relu-2.south);
\draw [-stealth,thick]   (dgn-relu-2.north) -- (dgn-f-c3.west);


\node [rotate=-90] (dgn-relu-1) at (2.5,1.5){\tiny{ReLU}};
\node [] (dgn-f-c1) at (1.75,1.5){\tiny{$C^{\text{f}}_1$}};
\draw [-stealth,thick]   (dgn-f-c1.east) -- (dgn-relu-1.south);
\draw [-stealth,thick]   (dgn-relu-1.north) -- (dgn-f-c2.west);



\node [] (dgn-f-input) at (0.75,1.5){$x^{\text{f}}$};
\draw [-stealth,thick]   (dgn-f-input.east) -- (dgn-f-c1.west);




\node []  (dgn-output) at (9.5,-2.5) {$\hat{y}(x)$};
\node [] (dgn-smax) at (8.5,-2.5){\tiny{FC}};
\draw [-stealth,thick]   (dgn-smax.east)--(dgn-output.west);

\node [rotate=-90] (dgn-gap) at (7.75,-2.5){\tiny{GAP}};
\draw [-stealth,thick]   (dgn-gap.north)--(dgn-smax.west);



\node [rotate=-90] (dgn-galu-4) at (7,-2.5){\tiny{GaLU}};
\draw [-stealth,thick]   (dgn-galu-4.north) -- (dgn-gap.south);

\node [] (dgn-v-c4) at (6.25,-2.5){\tiny{$C^{\text{v}}_4$}};
\draw [-stealth,thick]   (dgn-v-c4.east) -- (dgn-galu-4.south);

\node [rotate=-90] (dgn-galu-3) at (5.5,-2.5){\tiny{GaLU}};
\node [] (dgn-v-c3) at (4.75,-2.5){\tiny{$C^{\text{v}}_3$}};
\draw [-stealth,thick]   (dgn-v-c3.east) -- (dgn-galu-3.south);
\draw [-stealth,thick]   (dgn-galu-3.north) -- (dgn-v-c4.west);



\node [rotate=-90] (dgn-galu-2) at (4,-2.5){\tiny{GaLU}};
\node [] (dgn-v-c2) at (3.25,-2.5){\tiny{$C^{\text{v}}_2$}};
\draw [-stealth,thick]   (dgn-v-c2.east) -- (dgn-galu-2.south);
\draw [-stealth,thick]   (dgn-galu-2.north) -- (dgn-v-c3.west);


\node [rotate=-90] (dgn-galu-1) at (2.5,-2.5){\tiny{GaLU}};
\node [] (dgn-v-c1) at (1.75,-2.5){\tiny{$C^{\text{v}}_1$}};

\draw [-stealth,thick]   (dgn-v-c1.east) -- (dgn-galu-1.south);
\draw [-stealth,thick]   (dgn-galu-1.north) -- (dgn-v-c2.west);




\node [] (dgn-input) at (0.75,-2.5){$x^{\text{v}}$};
\draw [-stealth,thick]   (dgn-input.east) -- (dgn-v-c1.west);


\node[] (dgn-gating-1-up) at (2.5,0.5){\tiny{$G_{1}$}};
\draw [-stealth,thick]   (dgn-f-c1.east) to[out=-90,in=90] (dgn-gating-1-up.north);


\node[] (dgn-gating-2-up) at (4,0.5){\tiny{$G_{2}$}};
\draw [-stealth,thick]   (dgn-f-c2.east) to[out=-90,in=90] (dgn-gating-2-up.north);



\node[] (dgn-gating-3-up) at (5.5,0.5){\tiny{$G_{3}$}};
\draw [-stealth,thick]   (dgn-f-c3.east) to[out=-90,in=90] (dgn-gating-3-up.north);


\node[] (dgn-gating-4-up) at (7,0.5){\tiny{$G_{4}$}};
\draw [-stealth,thick]   (dgn-f-c4.east) to[out=-90,in=90] (dgn-gating-4-up.north);





\node[] (dgn-gating-1) at (2.5,-1.5){\tiny{$G_{i_1}$}};
\draw [-stealth,thick]   (dgn-gating-1.south) -- (dgn-galu-1.west);


\node[] (dgn-gating-2) at (4,-1.5){\tiny{$G_{i_2}$}};
\draw [-stealth,thick]   (dgn-gating-2.south) -- (dgn-galu-2.west);



\node[] (dgn-gating-3) at (5.5,-1.5){\tiny{$G_{i_3}$}};
\draw [-stealth,thick]   (dgn-gating-3.south) -- (dgn-galu-3.west);


\node[] (dgn-gating-4) at (7,-1.5){\tiny{$G_{i_4}$}};
\draw [-stealth,thick]   (dgn-gating-4.south) -- (dgn-galu-4.west);



\node[] (permutation) at (4.75,-0.5){\small{Layer Permutation}};

\draw [-]   (dgn-gating-1-up.south) -- (permutation.north);
\draw [-]   (dgn-gating-4-up.south) -- (permutation.north);
\draw [-]   (dgn-gating-2-up.south) -- (permutation.north);
\draw [-]   (dgn-gating-3-up.south) -- (permutation.north);



\draw [-]  (permutation.south) --  (dgn-gating-1.north)  ;
\draw [-]  (permutation.south) --  (dgn-gating-2.north)  ;
\draw [-]  (permutation.south) --  (dgn-gating-3.north)  ;
\draw [-]  (permutation.south) --  (dgn-gating-4.north)  ;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\node []  (fntext)at (-5.125,-3.5) {CNN-GAP-DLGN};

%\node []  (output) at (7.5,1.5) {$\hat{y}(x)$};


\node [] (dgn1-f-c4) at (-4,1.5){\tiny{$C^{\text{f}}_4$}};
\node [] (dgn1-f-c3) at (-5.5,1.5){\tiny{$C^{\text{f}}_3$}};
\node [] (dgn1-f-c2) at (-7,1.5){\tiny{$C^{\text{f}}_2$}};
\node [] (dgn1-f-c1) at (-8.5,1.5){\tiny{$C^{\text{f}}_1$}};
\node [] (dgn1-input-f) at (-9.5,1.5){$x^{\text{f}}$};
\draw [-stealth,thick]   (dgn1-f-c3.east) -- (dgn1-f-c4.west);
\draw [-stealth,thick]   (dgn1-f-c2.east) -- (dgn1-f-c3.west);
\draw [-stealth,thick]   (dgn1-f-c1.east) -- (dgn1-f-c2.west);
\draw [-stealth,thick]   (dgn1-input-f.east) -- (dgn1-f-c1.west);



\node []  (dgn1-output) at (-0.75,-2.5) {$\hat{y}(x)$};

\node [] (dgn1-smax) at (-1.75,-2.5){\tiny{FC}};
\draw [-stealth,thick]   (dgn1-smax.east)--(dgn1-output.west);

\node [rotate=-90] (dgn1-gap) at (-2.5,-2.5){\tiny{GAP}};
\draw [-stealth,thick]   (dgn1-gap.north)--(dgn1-smax.west);


\node [rotate=-90] (dgn1-galu-4) at (-3.25,-2.5){\tiny{GaLU}};
\draw [-stealth,thick]   (dgn1-galu-4.north)--(dgn1-gap.south);

\node [] (dgn1-v-c4) at (-4,-2.5){\tiny{$C^{\text{v}}_4$}};
\draw [-stealth,thick]   (dgn1-v-c4.east) -- (dgn1-galu-4.south);


\node [rotate=-90] (dgn1-galu-3) at (-4.75,-2.5){\tiny{GaLU}};
\draw [-stealth,thick]   (dgn1-galu-3.north) -- (dgn1-v-c4.west);

\node [] (dgn1-v-c3) at (-5.5,-2.5){\tiny{$C^{\text{v}}_3$}};
\draw [-stealth,thick]   (dgn1-v-c3.east) -- (dgn1-galu-3.south);


\node [rotate=-90] (dgn1-galu-2) at (-6.25,-2.5){\tiny{GaLU}};
\draw [-stealth,thick]   (dgn1-galu-2.north) -- (dgn1-v-c3.west);

\node [] (dgn1-v-c2) at (-7,-2.5){\tiny{$C^{\text{v}}_2$}};
\draw [-stealth,thick]   (dgn1-v-c2.east) -- (dgn1-galu-2.south);


\node [rotate=-90] (dgn1-galu-1) at (-7.75,-2.5){\tiny{GaLU}};
\draw [-stealth,thick]   (dgn1-galu-1.north) -- (dgn1-v-c2.west);


\node [] (dgn1-v-c1) at (-8.5,-2.5){\tiny{$C^{\text{v}}_1$}};
\draw [-stealth,thick]   (dgn1-v-c1.east) -- (dgn1-galu-1.south);


\node [] (dgn1-v-input) at (-9.5,-2.5){$x^{\text{v}}$};

\draw [-stealth,thick]   (dgn1-v-input.east) -- (dgn1-v-c1.west);


\node[] (dgn1-gating-4-up) at (-3.25,0.5){\tiny{$G_{4}$}};
\draw [-stealth,thick]   (dgn1-f-c4.east) to[out=-90,in=90] (dgn1-gating-4-up.north);


\node[] (dgn1-gating-3-up) at (-4.75,0.5){\tiny{$G_{3}$}};
\draw [-stealth,thick]   (dgn1-f-c3.east) to[out=-90,in=90] (dgn1-gating-3-up.north);



\node[] (dgn1-gating-2-up) at (-6.25,0.5){\tiny{$G_{2}$}};
\draw [-stealth,thick]   (dgn1-f-c2.east) to[out=-90,in=90] (dgn1-gating-2-up.north);


\node[] (dgn1-gating-1-up) at (-7.75,0.5){\tiny{$G_{1}$}};
\draw [-stealth,thick]   (dgn1-f-c1.east) to[out=-90,in=90] (dgn1-gating-1-up.north);





\node[] (dgn1-gating-4) at (-3.25,-1.5){\tiny{$G_{i_4}$}};
\draw [-stealth,thick]   (dgn1-gating-4.south) -- (dgn1-galu-4.west);


\node[] (dgn1-gating-3) at (-4.75,-1.5){\tiny{$G_{i_3}$}};
\draw [-stealth,thick]   (dgn1-gating-3.south) -- (dgn1-galu-3.west);



\node[] (dgn1-gating-2) at (-6.25,-1.5){\tiny{$G_{i_2}$}};
\draw [-stealth,thick]   (dgn1-gating-2.south) -- (dgn1-galu-2.west);


\node[] (dgn1-gating-1) at (-7.75,-1.5){\tiny{$G_{i_1}$}};
\draw [-stealth,thick]   (dgn1-gating-1.south) -- (dgn1-galu-1.west);



\node[] (permutation1) at (-5.5,-0.5){\small{Layer Permutation}};

\draw [-]   (dgn1-gating-1-up.south) -- (permutation1.north);
\draw [-]   (dgn1-gating-4-up.south) -- (permutation1.north);
\draw [-]   (dgn1-gating-2-up.south) -- (permutation1.north);
\draw [-]   (dgn1-gating-3-up.south) -- (permutation1.north);



\draw [-]  (permutation1.south) --  (dgn1-gating-1.north)  ;
\draw [-]  (permutation1.south) --  (dgn1-gating-2.north)  ;
\draw [-]  (permutation1.south) --  (dgn1-gating-3.north)  ;
\draw [-]  (permutation1.south) --  (dgn1-gating-4.north)  ;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


	
\end{tikzpicture}

